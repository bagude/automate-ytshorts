from typing import List
from datetime import datetime
from ..db import Story


def format_story_row(story: Story) -> List[str]:
    """Format a story for tabular display."""
    try:
        created_at = story.created_at.strftime(
            "%Y-%m-%d %H:%M") if isinstance(story.created_at, datetime) else str(story.created_at)
    except (AttributeError, ValueError):
        created_at = "Unknown"

    return [
        story.id[:8] + "...",  # Truncated ID
        story.title[:30] + "..." if len(story.title) > 30 else story.title,
        story.author,
        story.status,
        created_at,
        story.error[:50] + \
        "..." if story.error and len(story.error) > 50 else story.error or ""
    ]


def show_banner():
    """Return the ASCII art banner."""
    return """
.路:'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''':路.
: :                                                                                                                                                        : :
: :                                                                                                                                                        : :
: :       ____  _                _        _         _                        _           _  __     ___     _                 _             _ _             : :
: :      / ___|| |__   ___  _ __| |_     / \  _   _| |_ ___  _ __ ___   __ _| |_ ___  __| | \ \   / (_) __| | ___  ___      / \  _   _  __| (_) ___        : :
: :      \___ \| '_ \ / _ \| '__| __|   / _ \| | | | __/ _ \| '_ ` _ \ / _` | __/ _ \/ _` |  \ \ / /| |/ _` |/ _ \/ _ \    / _ \| | | |/ _` | |/ _ \       : :
: :       ___) | | | | (_) | |  | |_   / ___ \ |_| | || (_) | | | | | | (_| | ||  __/ (_| |   \ V / | | (_| |  __/ (_) |  / ___ \ |_| | (_| | | (_) |      : :
: :      |____/|_| |_|\___/|_|   \__| /_/   \_\__,_|\__\___/|_| |_| |_|\__,_|\__\___|\__,_|    \_/  |_|\__,_|\___|\___/  /_/   \_\__,_|\__,_|_|\___/       : :
: :       _   _                      _   _               _____           _            ______    ___     ___    _   _ _______                               : :
: :      | \ | | __ _ _ __ _ __ __ _| |_(_) ___  _ __   |_   _|__   ___ | |          / / ___|  / \ \   / / \  | \ | |_   _\ \                              : :
: :      |  \| |/ _` | '__| '__/ _` | __| |/ _ \| '_ \    | |/ _ \ / _ \| |  _____  | |\___ \ / _ \ \ / / _ \ |  \| | | |  | |                             : :
: :      | |\  | (_| | |  | | | (_| | |_| | (_) | | | |   | | (_) | (_) | | |_____| | | ___) / ___ \ V / ___ \| |\  | | |  | |                             : :
: :      |_| \_|\__,_|_|  |_|  \__,_|\__|_|\___/|_| |_|   |_|\___/ \___/|_|         | ||____/_/   \_\_/_/   \_\_| \_| |_|  | |                             : :
: :                                                                                  \_\                                  /_/                              : :
: :                                                                                                                                                        : :
: :                                                                                                                                                        : :
'路:........................................................................................................................................................:路'
"""
